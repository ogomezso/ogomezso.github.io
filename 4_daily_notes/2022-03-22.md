##### status: #daily_note 

# Tasks

#todo 
- [x] Contestar Arquitectura Julie
- [x] Contestar Panoramix

# Work Notes

# 2022-03-22 14:14
##### status: #meeting_note
##### Tags:

### Client:
### Topic:
### Attendees:
### Notes:

```SANES_GDOPEN_STATES_TABLE
CREATE TABLE SANES_GDOPEN_STATES_TABLE WITH (KAFKA_TOPIC='SANES.GDOPEN.STATES.STREAMING', PARTITIONS=3, REPLICAS=3, VALUE_AVRO_SCHEMA_FULL_NAME='es.santander.gdopen.StatesStreaming', VALUE_FORMAT='AVRO') AS SELECT  
CONTR.KEYOPERACION KEYOPERACION,  
PENDIENTE.OPERATIONID OPERATIONID,  
PENDIENTE.RESOLUTIONMARK RESOLUTIONMARK,  
PENDIENTE.OFFICE OFFICE,  
PENDIENTE.USERNUMBER USERNUMBER,  
PENDIENTE.RESOLUTIONDATE RESOLUTIONDATE,  
CONTR.CUENTAIMPUTACION[-1] IMPUTATIONACCOUNT,  
PENDIENTE.REVOKEDMARK REVOKEDMARK  
FROM SANES_GDOPEN_PL_RE_ORDEN_STATES_TABLE PENDIENTE  
LEFT OUTER JOIN SANES_GDOPEN_CP_ORDEN_CONTR_TABLE CONTR ON ((PENDIENTE.ROWKEY = CONTR.KEYOPERACION))  
EMIT CHANGES;
```

```SANES_GDOPEN_PL_RE_ORDEN_STATES_TABLE
CREATE TABLE SANES_GDOPEN_PL_RE_ORDEN_STATES_TABLE WITH (KAFKA_TOPIC='SANES.GDOPEN.KSQL.PL_RE_ORDEN_STATES_TABLE', PARTITIONS=3, REPLICAS=3) AS SELECT  
SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.ROWKEY ROWKEY,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.OPERATIONID) OPERATIONID,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.RESOLUTIONMARK) RESOLUTIONMARK,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.OFFICE) OFFICE,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.USERNUMBER) USERNUMBER,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.RESOLUTIONDATE) RESOLUTIONDATE,  
LATEST_BY_OFFSET(SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.REVOKEDMARK) REVOKEDMARK  
FROM SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM  
GROUP BY SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM.ROWKEY  
EMIT CHANGES;
```

```SANES_GDOPEN_CP_ORDEN_CONTR_TABLE
CREATE TABLE SANES_GDOPEN_CP_ORDEN_CONTR_TABLE WITH (KAFKA_TOPIC='SANES.GDOPEN.KSQL.CP_ORDEN_CONTR_TABLE', PARTITIONS=3, REPLICAS=3) AS SELECT  
CONCAT(SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDEMPR, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDCENT, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPROD, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->NUMSOR) KEYOPERACION,  
AS_VALUE(CONCAT(SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDEMPR, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDCENT, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPROD, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->NUMSOR)) IDOPERACION,  
COLLECT_LIST(CONCAT(SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDEMPR2, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDCENT2, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPRODC, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->NUMCTR)) CUENTAIMPUTACION,  
COLLECT_LIST(CONCAT(SANES_GDOPEN_CP_ORDEN_CONTR.BEFORE->IDEMPR2, SANES_GDOPEN_CP_ORDEN_CONTR.BEFORE->IDCENT2, SANES_GDOPEN_CP_ORDEN_CONTR.BEFORE->CODPRODC, SANES_GDOPEN_CP_ORDEN_CONTR.BEFORE->NUMCTR)) CUENTAIMPUTACION_OLD,  
LATEST_BY_OFFSET(SANES_GDOPEN_CP_ORDEN_CONTR.OPERATION) OPERATION  
FROM SANES_GDOPEN_CP_ORDEN_CONTR SANES_GDOPEN_CP_ORDEN_CONTR  
WHERE ((SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPROD = '633') OR (SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPROD = '755'))  
GROUP BY CONCAT(SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDEMPR, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->IDCENT, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->CODPROD, SANES_GDOPEN_CP_ORDEN_CONTR.AFTER->NUMSOR)  
EMIT CHANGES;
```

```SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM
CREATE OR REPLACE STREAM SANES_GDOPEN_PL_RE_ORDEN_STATES_STREAM WITH (KAFKA_TOPIC='SANES.GDOPEN.KSQL.PL_RE_ORDEN_STATES_STREAM', PARTITIONS=3, REPLICAS=3) AS SELECT  
SANES_GDOPEN_PL_RE_ORDEN_STREAM.ROWKEY ROWKEY,  
CONCAT(SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->IDEMPR, SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->IDCENT, SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CODPROD, SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->NUMSOR) OPERATIONID,  
(CASE WHEN (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->IDCENTD <> SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->IDCENTD) THEN 'RE' ELSE SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO END) RESOLUTIONMARK,  
SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->IDCENTD OFFICE,  
SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->USUMOD USERNUMBER,  
SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->TIMESMOD RESOLUTIONDATE,  
SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->TIMESMOD REVOKEDMARK  
FROM SANES_GDOPEN_PL_RE_ORDEN_STREAM SANES_GDOPEN_PL_RE_ORDEN_STREAM  
WHERE (((SANES_GDOPEN_PL_RE_ORDEN_STREAM.OPERATION = 'REPL') AND (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CODPROD = '633')) AND (((((((SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'APL') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'DEV')) AND ((SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'PTE') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'PAP'))) OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->IDCENTD <> SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->IDCENTD)) OR (((SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PAP') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PTE')) AND (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'APL'))) OR (((SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PAP') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PTE')) AND ((SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'PED') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'DEV')))) OR (((SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PTE') OR (SANES_GDOPEN_PL_RE_ORDEN_STREAM.BEFORE->CESTADO = 'PAP')) AND (SANES_GDOPEN_PL_RE_ORDEN_STREAM.AFTER->CESTADO = 'ANU'))))  
EMIT CHANGES;
```

```
CREATE STREAM SANES_GDOPEN_CP_ORDEN_CONTR (`TABLE` STRING, OPERATION STRING, BEFORE STRUCT<IDEMPR STRING, IDCENT STRING, CODPROD STRING, NUMSOR STRING, IDEMPR2 STRING, IDCENT2 STRING, CODPRODC STRING, NUMCTR STRING, FECINI STRING, FECVEC STRING, CORELCC STRING>, AFTER STRUCT<IDEMPR STRING, IDCENT STRING, CODPROD STRING, NUMSOR STRING, IDEMPR2 STRING, IDCENT2 STRING, CODPRODC STRING, NUMCTR STRING, FECINI STRING, FECVEC STRING, CORELCC STRING>) WITH (KAFKA_TOPIC='SANES.GDOPEN.CP_ORDEN_CONTR', KEY_FORMAT='KAFKA', VALUE_FORMAT='AVRO', VALUE_SCHEMA_ID=23);
```


# Meeting Notes

# 2022-03-22 09:39
##### status: #meeting_note
##### Tags:

### Client:
[[Santander]]

### Topic:
Daily

### Attendees:
* Ivan
* Miguel Angel
* Abel
* Oscar
* Dennis

### Notes:

- Prioridad a incidencia GDO2
- Pendiente de contestar a Panoramix
- Parallel Consumer
- Julie despriorizado seguimos con errores de conectividad

# 2022-03-22 15:35
##### status: #meeting_note
##### Tags:

### Client:
[[Santander]]

### Topic:
Parallel Consumer

### Attendees:
* Abel Alvarez
* Miguel 
* Fernando
* Daniel

### Notes:

Kstream + parallel consumer -> pruebas unitarias librer√≠a?? 